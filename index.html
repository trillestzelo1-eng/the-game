<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
  <title>❤️</title>

  <style>
    :root{
      --scale: 1;
    }

    *{ box-sizing:border-box; }

    body{
      margin:0;
      background:#000;
      display:flex;
      flex-direction:column;
      align-items:center;
      justify-content:center;
      height:100vh;
      overflow:hidden;
      -webkit-text-size-adjust:100%;
      touch-action: manipulation;
      font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Arial,sans-serif;
    }

    .arena{
      position:relative;
      flex:1;
      width:100%;
      display:flex;
      align-items:center;
      justify-content:center;
      overflow:hidden;
    }

    #character{
      width:320px;
      max-width:90vw;
      transform: scale(var(--scale));
      transition: transform 0.15s ease;
      user-select:none;
      -webkit-user-drag:none;
      pointer-events:none;
    }

    /* Message reveal */
    .message{
      color:#fff;
      font-weight:900;
      font-size: clamp(20px, 5vw, 28px);
      letter-spacing:0.5px;
      min-height:40px;
      margin-bottom:14px;
      text-align:center;
    }

    /* Yellow button */
    #btn{
      width:min(520px, 94%);
      margin-bottom:22px;
      padding:18px;
      font-size:22px;
      font-weight:1000;
      letter-spacing:1px;
      text-transform:uppercase;
      border:none;
      border-radius:14px;
      background:#ffd400;
      color:#000;
      cursor:pointer;

      touch-action: manipulation;
      -webkit-tap-highlight-color: transparent;
      user-select:none;
    }

    #btn:active{
      transform:scale(0.98);
    }

    /* Floating word */
    .wordPop{
      position:absolute;
      padding:10px 14px;
      background:rgba(255,255,255,0.12);
      border-radius:999px;
      font-weight:900;
      color:#fff;
      pointer-events:none;
      animation: rise 1.4s ease-out forwards;
      white-space:nowrap;
    }

    @keyframes rise{
      0%{ transform:translate(-50%,0) scale(0.9); opacity:0; }
      10%{ opacity:1; }
      100%{ transform:translate(-50%,-80px) scale(1.05); opacity:0; }
    }

    /* Hearts */
    .heart{
      position:absolute;
      font-size:22px;
      pointer-events:none;
      animation: floatUp 1.2s ease-out forwards;
    }

    @keyframes floatUp{
      0%{ transform:translate(var(--x0),var(--y0)); opacity:0; }
      10%{ opacity:1; }
      100%{ transform:translate(var(--x1),var(--y1)); opacity:0; }
    }
  </style>
</head>

<body>

  <div class="arena" id="arena">
    <img id="character" src="cartman.png" alt="Character">
  </div>

  <div class="message" id="message"></div>

  <button id="btn">INFLATE</button>

  <script>
    // iOS zoom prevention
    let lastTouchEnd = 0;
    document.addEventListener('touchend', function (event) {
      const now = Date.now();
      if (now - lastTouchEnd <= 300) event.preventDefault();
      lastTouchEnd = now;
    }, { passive: false });

    const character = document.getElementById("character");
    const arena = document.getElementById("arena");
    const btn = document.getElementById("btn");
    const messageEl = document.getElementById("message");

    let count = 0;

    const words = ["I", "love", "you,", "be", "my", "valentines"];
    let revealed = 0;

    const TOTAL_PRESSES = words.length * 50;
    const MIN_SCALE = 1;
    const MAX_SCALE = 3;

    function scaleForCount(c){
      const progress = Math.min(1, c / TOTAL_PRESSES);
      const eased = 1 - Math.pow(1 - progress, 2.2);
      return MIN_SCALE + (MAX_SCALE - MIN_SCALE) * eased;
    }

    function applyScale(){
      const s = scaleForCount(count);
      document.documentElement.style.setProperty("--scale", s.toFixed(3));
    }

    function popWord(word){
      const rect = character.getBoundingClientRect();
      const arenaRect = arena.getBoundingClientRect();

      const x = rect.left + rect.width/2 - arenaRect.left;
      const y = rect.top + rect.height*0.6 - arenaRect.top;

      const w = document.createElement("div");
      w.className = "wordPop";
      w.textContent = word;
      w.style.left = x + "px";
      w.style.top = y + "px";
      arena.appendChild(w);

      setTimeout(()=>w.remove(), 1500);
    }

    function spawnHearts(amount){
      const rect = character.getBoundingClientRect();
      const arenaRect = arena.getBoundingClientRect();

      const sx = rect.left + rect.width/2 - arenaRect.left;
      const sy = rect.top + rect.height*0.6 - arenaRect.top;

      for(let i=0;i<amount;i++){
        const h = document.createElement("div");
        h.className="heart";
        h.textContent="❤️";

        const dx0=(Math.random()*20-10)+"px";
        const dy0="0px";
        const dx1=(Math.random()*300-150)+"px";
        const dy1=-(Math.random()*250+60)+"px";

        h.style.left=sx+"px";
        h.style.top=sy+"px";
        h.style.setProperty("--x0",dx0);
        h.style.setProperty("--y0",dy0);
        h.style.setProperty("--x1",dx1);
        h.style.setProperty("--y1",dy1);

        arena.appendChild(h);
        setTimeout(()=>h.remove(),1300);
      }
    }

    function maybeReveal(){
      if(count % 50 === 0 && revealed < words.length){
        const word = words[revealed];
        revealed++;
        popWord(word);
        messageEl.textContent = words.slice(0,revealed).join(" ");
        spawnHearts(20);

        if(revealed === words.length){
          spawnHearts(80);
        }
      }
    }

    function inflate(){
      count++;
      applyScale();
      maybeReveal();
    }

    btn.addEventListener("pointerdown", (e)=>{
      e.preventDefault();
      inflate();
    });

    applyScale();
  </script>

</body>
</html>

